<div class="welcome-container">
  <div class="container">
    <h1>Welcome back, <%= current_user.first_name %></h1>

    <h3>You're set to attend <strong><%= @next_events.count %></strong> <%= "event".pluralize(@next_events.count) %></h3>
  </div>
  <section class="events">
    <%= render "events/event_cards", events: @next_events  %>
  </section>
</div>

<div class="container">
  <h3>You've attendeed <strong><%= @past_events.count %></strong> <%= "event".pluralize(@past_events.count) %></h3>
</div>
<section class="events">
    <%= render "events/event_cards", events: @past_events  %>
</section>

<div class="container schedule-container">
  <div class="row">


<!-- Affichage des logos de sport pour la sélection des favoris -->
<div class="gpt-sports-container my-4">
  <%= form_tag(dashboard_path, method: :get, class: "gpt-update-favorites-form") do %>
    <div class="row row-cols-3 justify-content-center gpt-sport-cards-row">
      <% Category.all.each do |category| %>
        <div class="col gpt-sport-card-col">
          <div class="card custom-label gpt-sport-card <% if current_user.favourite_categories.include?(category) %>gpt-border-selected<% end %>" id="gpt_category_card_<%= category.id %>">
            <%= check_box_tag "categories[]", category.id, current_user.favourite_categories.include?(category), id: "gpt_category_#{category.id}", class: "category-input", data: { action: "click->gpt-myfavs#toggleSelection" } %>
            <label for="gpt_category_#{category.id}" class="stretched-link">
              <img src="<%= image_path("#{category.sport.downcase}.png") %>" alt="<%= category.sport %>" class="gpt-card-img">
            </label>
          </div>
        </div>
      <% end %>
    </div>
    <div class="row justify-content-center">
      <div class="col-12 text-center mt-4">
        <%= submit_tag "Update favorites", class: "btn-update-favorites" %>
      </div>
    </div>
  <% end %>
</div>

<script>
// JavaScript pour la sélection des cartes
document.addEventListener('DOMContentLoaded', () => {
  const cards = document.querySelectorAll('.gpt-sport-card');

  cards.forEach(card => {
    const checkbox = card.querySelector('.category-input');
    // Marquer visuellement les cartes sélectionnées au chargement
    if (checkbox.checked) {
      card.classList.add('gpt-border-selected');
    }

    card.addEventListener('click', () => {
      checkbox.checked = !checkbox.checked; // Basculer la sélection
      card.classList.toggle('gpt-border-selected'); // Basculer la classe de sélection
    });
  });
});

</script>
